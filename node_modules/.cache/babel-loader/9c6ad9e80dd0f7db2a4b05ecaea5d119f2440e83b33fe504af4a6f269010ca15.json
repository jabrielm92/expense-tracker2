{"ast":null,"code":"import * as d3 from 'd3';\nimport { db, auth } from '@/firebase.js';\nexport default {\n  name: 'ChartComponent',\n  data() {\n    return {\n      incomeTotal: 0,\n      expenseTotal: 0\n    };\n  },\n  created() {\n    this.fetchData();\n  },\n  methods: {\n    fetchData() {\n      const userId = auth.currentUser.uid;\n      db.collection(`users/${userId}/income`).get().then(querySnapshot => {\n        let total = 0;\n        querySnapshot.forEach(doc => {\n          total += doc.data().amount;\n        });\n        this.incomeTotal = total;\n        this.drawChart();\n      }).catch(error => {\n        console.error('Error fetching income total:', error);\n      });\n      db.collection(`users/${userId}/expenses`).get().then(querySnapshot => {\n        let total = 0;\n        querySnapshot.forEach(doc => {\n          total += doc.data().amount;\n        });\n        this.expenseTotal = total;\n        this.drawChart();\n      }).catch(error => {\n        console.error('Error fetching expense total:', error);\n      });\n    },\n    drawChart() {\n      // only draw the chart when we have fetched both income and expense data\n      if (this.incomeTotal && this.expenseTotal) {\n        const data = [{\n          label: 'Income',\n          value: this.incomeTotal\n        }, {\n          label: 'Expenses',\n          value: this.expenseTotal\n        }];\n        const width = 300;\n        const height = 300;\n        const radius = Math.min(width, height) / 2;\n        const svg = d3.select('#pie-chart').append('svg').attr('width', width).attr('height', height).append('g').attr('transform', `translate(${width / 2},${height / 2})`);\n        const color = d3.scaleOrdinal().domain(data.map(d => d.label)).range(['#5CB85C', '#D9534F']);\n        const pie = d3.pie().sort(null).value(d => d.value);\n        const path = d3.arc().outerRadius(radius - 10).innerRadius(0);\n        const label = d3.arc().outerRadius(radius - 40).innerRadius(radius - 40);\n        const arc = svg.selectAll('.arc').data(pie(data)).enter().append('g').attr('class', 'arc');\n        arc.append('path').attr('d', path).attr('fill', d => color(d.data.label));\n        arc.append('text').attr('transform', d => `translate(${label.centroid(d)})`).attr('dy', '0.35em').text(d => d.data.label);\n      }\n    }\n  }\n};","map":{"version":3,"names":["d3","db","auth","name","data","incomeTotal","expenseTotal","created","fetchData","methods","userId","currentUser","uid","collection","get","then","querySnapshot","total","forEach","doc","amount","drawChart","catch","error","console","label","value","width","height","radius","Math","min","svg","select","append","attr","color","scaleOrdinal","domain","map","d","range","pie","sort","path","arc","outerRadius","innerRadius","selectAll","enter","centroid","text"],"sources":["C:\\Users\\jabri\\Desktop\\expense-tracker2\\src\\components\\ChartComponent.vue"],"sourcesContent":["<template>\r\n    <div id=\"pie-chart\"></div>\r\n  </template>\r\n  \r\n  <script>\r\n  import * as d3 from 'd3';\r\n  import { db, auth } from '@/firebase.js';\r\n  \r\n  export default {\r\n    name: 'ChartComponent',\r\n    data() {\r\n      return {\r\n        incomeTotal: 0,\r\n        expenseTotal: 0\r\n      };\r\n    },\r\n    created() {\r\n      this.fetchData();\r\n    },\r\n    methods: {\r\n      fetchData() {\r\n        const userId = auth.currentUser.uid;\r\n        db.collection(`users/${userId}/income`).get()\r\n          .then((querySnapshot) => {\r\n            let total = 0;\r\n            querySnapshot.forEach((doc) => {\r\n              total += doc.data().amount;\r\n            });\r\n            this.incomeTotal = total;\r\n            this.drawChart();\r\n          })\r\n          .catch((error) => {\r\n            console.error('Error fetching income total:', error);\r\n          });\r\n          \r\n        db.collection(`users/${userId}/expenses`).get()\r\n          .then((querySnapshot) => {\r\n            let total = 0;\r\n            querySnapshot.forEach((doc) => {\r\n              total += doc.data().amount;\r\n            });\r\n            this.expenseTotal = total;\r\n            this.drawChart();\r\n          })\r\n          .catch((error) => {\r\n            console.error('Error fetching expense total:', error);\r\n          });\r\n      },\r\n      drawChart() {\r\n        // only draw the chart when we have fetched both income and expense data\r\n        if (this.incomeTotal && this.expenseTotal) {\r\n          const data = [\r\n            { label: 'Income', value: this.incomeTotal },\r\n            { label: 'Expenses', value: this.expenseTotal }\r\n          ];\r\n          \r\n          const width = 300;\r\n          const height = 300;\r\n          const radius = Math.min(width, height) / 2;\r\n  \r\n          const svg = d3.select('#pie-chart')\r\n            .append('svg')\r\n            .attr('width', width)\r\n            .attr('height', height)\r\n            .append('g')\r\n            .attr('transform', `translate(${width / 2},${height / 2})`);\r\n  \r\n          const color = d3.scaleOrdinal()\r\n            .domain(data.map(d => d.label))\r\n            .range(['#5CB85C', '#D9534F']);\r\n  \r\n          const pie = d3.pie()\r\n            .sort(null)\r\n            .value(d => d.value);\r\n  \r\n          const path = d3.arc()\r\n            .outerRadius(radius - 10)\r\n            .innerRadius(0);\r\n  \r\n          const label = d3.arc()\r\n            .outerRadius(radius - 40)\r\n            .innerRadius(radius - 40);\r\n  \r\n          const arc = svg.selectAll('.arc')\r\n            .data(pie(data))\r\n            .enter()\r\n            .append('g')\r\n            .attr('class', 'arc');\r\n  \r\n          arc.append('path')\r\n            .attr('d', path)\r\n            .attr('fill', d => color(d.data.label));\r\n  \r\n          arc.append('text')\r\n            .attr('transform', d => `translate(${label.centroid(d)})`)\r\n            .attr('dy', '0.35em')\r\n            .text(d => d.data.label);\r\n        }\r\n      }\r\n    }\r\n  };\r\n  </script>\r\n  \r\n\r\n  \r\n  \r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}