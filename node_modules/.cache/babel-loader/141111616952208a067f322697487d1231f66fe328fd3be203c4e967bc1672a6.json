{"ast":null,"code":"import { db, auth } from '@/firebase.js';\nimport * as d3 from 'd3';\nexport default {\n  name: 'ChartComponent',\n  data() {\n    return {\n      data: []\n    };\n  },\n  mounted() {\n    this.fetchData();\n  },\n  methods: {\n    fetchData() {\n      const userId = auth.currentUser.uid;\n      const incomeRef = db.collection(`users/${userId}/income`);\n      const expenseRef = db.collection(`users/${userId}/expenses`);\n      Promise.all([incomeRef.get(), expenseRef.get()]).then(data => {\n        const income = data[0];\n        const expense = data[1];\n        const incomeTotal = income.docs.reduce((acc, cur) => acc + cur.data().amount, 0);\n        const expenseTotal = expense.docs.reduce((acc, cur) => acc + cur.data().amount, 0);\n        const chartData = [{\n          type: 'income',\n          value: incomeTotal\n        }, {\n          type: 'expense',\n          value: expenseTotal\n        }];\n        this.data = chartData;\n        this.drawChart();\n      });\n    },\n    drawChart() {\n      const svg = d3.select('svg');\n      const width = svg.attr('width');\n      const height = svg.attr('height');\n      const radius = Math.min(width, height) / 2;\n      const g = svg.append('g').attr('transform', `translate(${width / 2},${height / 2})`);\n      const color = d3.scaleOrdinal(['#4CAF50', '#F44336']);\n      const pie = d3.pie().sort(null).value(d => d.value);\n      const path = d3.arc().outerRadius(radius - 10).innerRadius(0);\n      const label = d3.arc().outerRadius(radius).innerRadius(radius - 80);\n      const arc = g.selectAll('.arc').data(pie(this.data)).enter().append('g').attr('class', 'arc');\n      arc.append('path').attr('d', path).attr('fill', d => color(d.data.type)).on('mouseover', function (d) {\n        d3.select(this).transition().duration('50').attr('opacity', '.85');\n      }).on('mouseout', function (d) {\n        d3.select(this).transition().duration('50').attr('opacity', '1');\n      });\n      arc.append('text').attr('transform', d => `translate(${label.centroid(d)})`).attr('dy', '0.35em').text(d => d.data.type.charAt(0).toUpperCase() + d.data.type.slice(1));\n    }\n  }\n};","map":{"version":3,"names":["db","auth","d3","name","data","mounted","fetchData","methods","userId","currentUser","uid","incomeRef","collection","expenseRef","Promise","all","get","then","income","expense","incomeTotal","docs","reduce","acc","cur","amount","expenseTotal","chartData","type","value","drawChart","svg","select","width","attr","height","radius","Math","min","g","append","color","scaleOrdinal","pie","sort","d","path","arc","outerRadius","innerRadius","label","selectAll","enter","on","transition","duration","centroid","text","charAt","toUpperCase","slice"],"sources":["C:\\Users\\jabri\\Desktop\\expense-tracker2\\src\\components\\ChartComponent.vue"],"sourcesContent":["<template>\r\n    <div class=\"chart\">\r\n      <h2>Transactions Breakdown</h2>\r\n      <svg></svg>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import { db, auth } from '@/firebase.js';\r\n  import * as d3 from 'd3';\r\n  \r\n  export default {\r\n    name: 'ChartComponent',\r\n    data() {\r\n      return {\r\n        data: [],\r\n      };\r\n    },\r\n    mounted() {\r\n      this.fetchData();\r\n    },\r\n    methods: {\r\n      fetchData() {\r\n        const userId = auth.currentUser.uid;\r\n        const incomeRef = db.collection(`users/${userId}/income`);\r\n        const expenseRef = db.collection(`users/${userId}/expenses`);\r\n  \r\n        Promise.all([incomeRef.get(), expenseRef.get()]).then((data) => {\r\n          const income = data[0];\r\n          const expense = data[1];\r\n          const incomeTotal = income.docs.reduce((acc, cur) => acc + cur.data().amount, 0);\r\n          const expenseTotal = expense.docs.reduce((acc, cur) => acc + cur.data().amount, 0);\r\n  \r\n          const chartData = [\r\n            { type: 'income', value: incomeTotal },\r\n            { type: 'expense', value: expenseTotal },\r\n          ];\r\n  \r\n          this.data = chartData;\r\n          this.drawChart();\r\n        });\r\n      },\r\n      drawChart() {\r\n        const svg = d3.select('svg');\r\n        const width = svg.attr('width');\r\n        const height = svg.attr('height');\r\n        const radius = Math.min(width, height) / 2;\r\n  \r\n        const g = svg\r\n          .append('g')\r\n          .attr('transform', `translate(${width / 2},${height / 2})`);\r\n  \r\n        const color = d3.scaleOrdinal(['#4CAF50', '#F44336']);\r\n  \r\n        const pie = d3\r\n          .pie()\r\n          .sort(null)\r\n          .value((d) => d.value);\r\n  \r\n        const path = d3\r\n          .arc()\r\n          .outerRadius(radius - 10)\r\n          .innerRadius(0);\r\n  \r\n        const label = d3\r\n          .arc()\r\n          .outerRadius(radius)\r\n          .innerRadius(radius - 80);\r\n  \r\n        const arc = g\r\n          .selectAll('.arc')\r\n          .data(pie(this.data))\r\n          .enter()\r\n          .append('g')\r\n          .attr('class', 'arc');\r\n  \r\n        arc\r\n          .append('path')\r\n          .attr('d', path)\r\n          .attr('fill', (d) => color(d.data.type))\r\n          .on('mouseover', function (d) {\r\n            d3.select(this).transition().duration('50').attr('opacity', '.85');\r\n          })\r\n          .on('mouseout', function (d) {\r\n            d3.select(this).transition().duration('50').attr('opacity', '1');\r\n          });\r\n  \r\n        arc\r\n          .append('text')\r\n          .attr('transform', (d) => `translate(${label.centroid(d)})`)\r\n          .attr('dy', '0.35em')\r\n          .text((d) => d.data.type.charAt(0).toUpperCase() + d.data.type.slice(1));\r\n      },\r\n    },\r\n  };\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .chart {\r\n    max-width: 600px;\r\n    margin: 0 auto;\r\n    text-align: center;\r\n  }\r\n  </style>\r\n  \r\n  \r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}